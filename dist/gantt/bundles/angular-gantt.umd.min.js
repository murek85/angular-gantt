!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/forms"),require("@angular/common"),require("@angular/core")):"function"==typeof define&&define.amd?define("angular-gantt",["exports","@angular/forms","@angular/common","@angular/core"],e):e(t["angular-gantt"]={},t.ng.forms,t.ng.common,t.ng.core)}(this,function(t,e,n,i){"use strict";var r={hours:0,days:1,weeks:2};r[r.hours]="hours",r[r.days]="days",r[r.weeks]="weeks";var o=(a.decorators=[{type:i.Injectable}],a);function a(){this.cellWidth=76,this.rowHeight=25,this.activityHeight=300,this.barHeight=20,this.barLineHeight=20,this.barMoveable=!1}var s=(c.prototype.transform=function(t,n){var i={};return t.forEach(function(t){var e=JSON.stringify(n(t));i[e]=i[e]||[],i[e].push(t)}),Object.keys(i).map(function(t){return i[t]})},c.decorators=[{type:i.Pipe,args:[{name:"groupBy"}]}],c);function c(){}var l=(d.prototype.calculateBarWidth=function(t,e,n){"string"==typeof t&&(t=new Date(t)),"string"==typeof e&&(e=new Date(e));var i=this.calculateDiffDays(t,e),r=i*this.cellWidth+i;return n&&(r=i*this.hourCellWidth*24+24*i),r},d.prototype.calculateBarLeft=function(t,e,n){var i=0;if(null!=t){"string"==typeof t&&(t=new Date);for(var r=0;r<e.length;r++)if(t.getDate()===e[r].getDate()){i=n?24*r*this.hourCellWidth+24*r+this.calculateBarLeftDelta(t,n):r*this.cellWidth+r+this.calculateBarLeftDelta(t,n);break}}return i},d.prototype.calculateGanttHeight=function(){return this.TASK_CACHE.length*this.rowHeight+3*this.rowHeight+"px"},d.prototype.calculateBarLeftDelta=function(t,e){var n=t.getHours()+t.getMinutes()/60+t.getSeconds()/3600;return e?this.hoursCellWidth/24*n-n:this.cellWidth/24*n},d.prototype.isParent=function(t){try{if(1===t.split("/").length)return!0}catch(e){return!1}return!1},d.prototype.isChild=function(t){return this.isParent(t)?"0px":"20px"},d.prototype.calculateBar=function(t,e,n,i){var r=this.getBarStyle(t.status);return{top:this.barTop*e+2+"px",left:this.calculateBarLeft(t.start,n,i)+"px",height:this.barHeight+"px","line-height":this.barLineHeight+"px",width:this.calculateBarWidth(t.start,t.end,i)+"px","background-color":r["background-color"],border:r.border}},d.prototype.getBarStyle=function(t){void 0===t&&(t="");var e={};try{t=t.toLowerCase()}catch(n){t=""}switch(t){case"information":e["background-color"]=this.barStyles[0].backgroundColor,e.border=this.barStyles[0].border;break;case"warning":e["background-color"]=this.barStyles[1].backgroundColor,e.border=this.barStyles[1].border;break;case"error":e["background-color"]=this.barStyles[2].backgroundColor,e.border=this.barStyles[2].border;break;case"completed":e["background-color"]=this.barStyles[3].backgroundColor,e.border=this.barStyles[3].border;break;default:e["background-color"]="rgb(18,195, 244)",e.border="1px solid #2196F3"}return e},d.prototype.getBarProgressStyle=function(t){void 0===t&&(t="");var e={};try{t=t.toLowerCase()}catch(n){t=""}switch(t){case"information":e["background-color"]=this.barStyles[0].progressBackgroundColor;break;case"warning":e["background-color"]=this.barStyles[1].progressBackgroundColor;break;case"error":e["background-color"]=this.barStyles[2].progressBackgroundColor;break;case"completed":e["background-color"]=this.barStyles[3].progressBackgroundColor;break;default:e["background-color"]=this.barStyles[0].progressBackgroundColor}return e},d.prototype.calculateBarProgress=function(t,e){return"number"!=typeof e?"0px":(100<e&&(e=100),t/100*e-2+"px")},d.prototype.calculateDiffDays=function(t,e){try{return Math.abs((t.getTime()-e.getTime())/864e5)}catch(n){return 0}},d.prototype.calculateDuration=function(t){try{if(null==t.start||null==t.end)return"";var e=Math.abs((t.start.getTime()-t.end.getTime())/36e5);if(24<e)return Math.round(e/24)+" day(s)";if(1<e)return Math.round(e)+" hr(s)";var n=60*e;return n<1?Math.round(60*n)+" second(s)":Math.round(n)+" min(s)"}catch(i){return""}},d.prototype.calculateTotalDuration=function(t){try{t=t.filter(function(t){return t.parentId===t.id});for(var e=0,n=0;n<t.length;n++){var i=t[n].start,r=t[n].end;null!=i&&null!=r&&(e+=Math.abs(t[n].end.getTime()-t[n].start.getTime())/36e5)}if(0===e)return"";if(24<e)return Math.round(e/24)+" day(s)";if(1<e)return Math.round(e)+" hr(s)";var o=60*e;return o<1?Math.round(60*o)+" second(s)":Math.round(o)+" min(s)"}catch(a){return""}},d.prototype.calculateTotalPercentage=function(t){var e=0,n=t.children;return 0<n.length?(n.forEach(function(t){e+=isNaN(t.percentComplete)?0:t.percentComplete}),Math.ceil(e/n.length)):isNaN(t.percentComplete)?0:t.percentComplete},d.prototype.calculateParentTotalPercentage=function(e,t){var n=t.filter(function(t){return t.parentId===e.id&&t.id!=e.id}),i=0;return 0<n.length?(n.forEach(function(t){i+=isNaN(t.percentComplete)?0:t.percentComplete}),Math.ceil(i/n.length)):isNaN(e.percentComplete)?0:e.percentComplete},d.prototype.calculateScale=function(t,e){void 0===t&&(t=new Date),void 0===e&&(e=this.addDays(t,7));var n=[];try{for(;t.getTime()<=e.getTime();)n.push(t),t=this.addDays(t,1);return n}catch(i){return n}},d.prototype.isDayWeekend=function(t){var e=t.getDay();return 6===e||0===e},d.prototype.addDays=function(t,e){var n=new Date(t);return n.setDate(n.getDate()+e),n},d.prototype.removeDays=function(t,e){var n=new Date(t);return n.setDate(n.getDate()-e),n},d.prototype.calculateGridScale=function(t){var e=t.map(function(t){return{start:new Date(t.start),end:new Date(t.end)}});return{start:new Date(Math.min.apply(null,e.map(function(t){return t.start}))),end:new Date(Math.max.apply(null,e.map(function(t){return t.end})))}},d.prototype.getHours=function(t){for(var e=[];e.length<=24*t;)for(var n=0;n<=23;n++)n<10?e.push("0"+n.toString()):e.push(n.toString());return e},d.prototype.getComputedStyle=function(t,e){return parseInt(document.defaultView.getComputedStyle(t)[e],10)},d.prototype.calculateContainerWidth=function(){return this.windowInnerWidth=window.innerWidth,innerWidth-18},d.prototype.calculateActivityContainerDimensions=function(){this.windowInnerWidth=window.innerWidth;var t=this.windowInnerWidth-this.gridWidth-18;return{height:this.activityHeight,width:t}},d.prototype.scrollTop=function(t,e,n){var i=t.scrollTop,r=this.setScrollTop;null!==i&&i!==undefined&&setTimeout(function(){r(i,n),r(n.scrollTop,e)},50)},d.prototype.groupData=function(t){var e=(new s).transform(t,function(t){return[t.treePath.split("/")[0]]});return[].concat.apply([],e)},d.prototype.transformData=function(t){for(var e=[],n=0;n<t.length;n++)for(var i=t[n].id.split("/"),r=e,o=0;o<i.length;o++){for(var a=i[o],s=r,c=0;c<r.length;c++)if(r[c].name==a){r=r[c].children;break}s==r&&(r=(r[c]={name:a,percentComplete:t[n].percentComplete,start:t[n].start,end:t[n].end,children:[]}).children)}return e},d.prototype.doTaskCheck=function(t,e){var n=this,i=this.TASK_CACHE.map(function(t){return t.id}),r=[];return e?t.filter(function(t){return-1===i.indexOf(t.id)}).forEach(function(t){r.push(t)}):t.filter(function(t){return-1===i.indexOf(t.id)&&1===t.treePath.split("/").length}).forEach(function(t){r.push(t)}),r.forEach(function(t){n.TASK_CACHE.push(t)}),0<r.length},d.prototype.setIdPrefix=function(t){return"_"+t},d.prototype.setScrollTop=function(t,e){null!==e&&e!==undefined&&(e.scrollTop=t)},d.decorators=[{type:i.Injectable}],d.ctorParameters=function(){return[]},d);function d(){this.rowHeight=0,this.hourCellWidth=60,this.hoursCellWidth=25*this.hourCellWidth,this.cellWidth=0,this.windowInnerWidth=0,this.activityHeight=0,this.barHeight=0,this.barLineHeight=0,this.barTop=0,this.barMoveable=!1,this.gridWidth=560,this.barStyles=[{status:"information",backgroundColor:"rgb(18,195, 244)",border:"1px solid #2196F3",progressBackgroundColor:"#2196F3"},{status:"warning",backgroundColor:"#FFA726",border:"1px solid #EF6C00",progressBackgroundColor:"#EF6C00"},{status:"error",backgroundColor:"#EF5350",border:"1px solid #C62828",progressBackgroundColor:"#C62828"},{status:"completed",backgroundColor:"#66BB6A",border:"1px solid #2E7D32",progressBackgroundColor:"#2E7D32"}];var t=new o;this.rowHeight=t.rowHeight,this.cellWidth=t.cellWidth,this.activityHeight=t.activityHeight,this.barHeight=t.barHeight,this.barLineHeight=t.barLineHeight,this.barTop=t.rowHeight,this.barMoveable=t.barMoveable}var h=(Object.defineProperty(p.prototype,"project",{get:function(){return this._project},set:function(t){t?this._project=t:this.setDefaultProject()},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"options",{get:function(){return this._options},set:function(t){t.scale?this._options=t:this.setDefaultOptions()},enumerable:!0,configurable:!0}),p.prototype.ngOnInit=function(){},p.prototype.setSizes=function(){this.ganttContainerWidth=this.ganttService.calculateContainerWidth()},p.prototype.setDefaultOptions=function(){var t=this.ganttService.calculateGridScale(this._project.tasks);this._options={scale:t}},p.prototype.setDefaultProject=function(){this._project={id:"",name:"",startDate:null,tasks:[]}},p.prototype.gridRowClicked=function(t){this.onGridRowClick.emit(t)},p.prototype.onResize=function(t){this.setSizes()},p.decorators=[{type:i.Component,args:[{selector:"gantt",template:'\n        <div style="width: 100%">\n            <div class="gantt_container" (window:resize)="onResize($event)">\n                <gantt-header [name]="_project.name" [startDate]="_project.startDate"></gantt-header>\n                <gantt-activity [project]="_project" [options]="_options" (onGridRowClick)="gridRowClicked($event)"></gantt-activity>\n                <gantt-footer [project]="_project"></gantt-footer>\n            </div>\n        </div>\n    ',providers:[],styles:["\n        .gantt_container {\n            font-family: Arial;\n            font-size: 13px;\n            border: 1px solid #cecece;\n            position: relative;\n            white-space: nowrap;\n            margin-top: 0px;\n        }\n    "]}]}],p.ctorParameters=function(){return[{type:l}]},p.propDecorators={project:[{type:i.Input}],options:[{type:i.Input}],onGridRowClick:[{type:i.Output}]},p);function p(t){this.ganttService=t,this.onGridRowClick=new i.EventEmitter}var g=(u.decorators=[{type:i.Component,args:[{selector:"gantt-header",template:'\n        <div class="gantt-header">\n            <div class="gantt-header-title">\n                <div style="flex:1">{{ name }}</div>\n                <div>Started: {{ startDate | date: \'medium\'}}</div>\n            </div>\n        </div>\n    ',styles:["\n        .gantt-header {\n            background-color: whitesmoke;\n            height: 40px;\n            border-bottom: 1px solid #e0e0e0;\n        }\n\n        .gantt-header-title {\n            padding: 12px;\n            display: flex;\n            flex-wrap:wrap;\n            font-family: Arial, Helvetica, sans-serif;\n            font-size: 16px;\n        }\n\n        .gantt-header-actions {\n            display: inline;\n            float: right;\n            padding: 6px;\n        }\n    "]}]}],u.propDecorators={name:[{type:i.Input}],startDate:[{type:i.Input}]},u);function u(){}var v=(y.decorators=[{type:i.Component,args:[{selector:"gantt-footer",template:'<div class="gantt-footer"></div>',styles:["\n        .gantt-footer {\n            background-color: whitesmoke;\n            height: 36px;\n            border-top: 1px solid #e0e0e0;\n        }\n\n        .gantt-footer-actions {\n            float: right;\n        }\n    "]}]}],y.ctorParameters=function(){return[]},y.propDecorators={project:[{type:i.Input}]},y);function y(){}var f=(m.prototype.ngOnInit=function(){this.ganttService.TASK_CACHE=this.project.tasks.slice(0).filter(function(t){return 1===t.treePath.split("/").length}),this.ganttService.TIME_SCALE=this.ganttService.calculateScale(this.options.scale.start,this.options.scale.end),this.zoomLevel=this.options.zooming,this.start=this.options.scale.start,this.end=this.options.scale.end,this.containerWidth=this.calculateContainerWidth(),this.containerHeight=this.calculateContainerHeight(),this.activityContainerSizes=this.ganttService.calculateActivityContainerDimensions(),this.setScale(),this.setDimensions(),this.setSizes(),this.expand()},m.prototype.ngDoCheck=function(){this.ganttService.doTaskCheck(this.project.tasks,this.treeExpanded)&&this.activityActions.expanded&&this.expand(!0)},m.prototype.onVerticalScroll=function(t,e,n){this.ganttService.scrollTop(t,e,n)},m.prototype.toggleChildren=function(t,e){var n=this;try{var i="true"===t.getAttribute("data-isparent"),r=t.getAttribute("data-parentid").replace("_",""),o=document.querySelectorAll("[data-parentid="+t.getAttribute("data-parentid")+"][data-isparent=false]");i&&(0<o.length?this.ganttService.TASK_CACHE.filter(function(t){return t.parentId==r&&1<t.treePath.split("/").length}).map(function(t){return t.id}).forEach(function(t){var e=n.ganttService.TASK_CACHE.map(function(t){return t.id}).indexOf(t);n.ganttService.TASK_CACHE.splice(e,1)}):this.project.tasks.filter(function(t){return t.parentId===r&&1<t.treePath.split("/").length}).forEach(function(t){n.ganttService.TASK_CACHE.push(t)}),this.activityActions.expanded&&this.expand(!0)),this.onGridRowClick.emit(e)}catch(a){}},m.prototype.toggleAllChildren=function(){var n=this;try{var t=document.querySelectorAll("[data-isparent=false]"),e=Array.prototype.slice.call(t).map(function(t){return t.getAttribute("data-id").replace("_","")});if(this.treeExpanded)0<t.length&&this.ganttService.TASK_CACHE.filter(function(t){return 1<t.treePath.split("/").length}).map(function(t){return t.id}).forEach(function(t){var e=n.ganttService.TASK_CACHE.map(function(t){return t.id}).indexOf(t);n.ganttService.TASK_CACHE.splice(e,1)}),this.treeExpanded=!1,this.activityActions.expanded&&this.expand(!0);else{var i=this.project.tasks.filter(function(t){return 1<t.treePath.split("/").length});0<t.length&&(i=i.filter(function(t){return-1===e.indexOf(t.id)})),i.forEach(function(t){n.ganttService.TASK_CACHE.push(t)}),this.treeExpanded=!0,this.activityActions.expanded&&this.expand(!0)}}catch(r){}},m.prototype.onResize=function(t){var e=this.ganttService.calculateActivityContainerDimensions();this.activityActions.expanded?this.ganttActivityHeight=this.ganttService.TASK_CACHE.length*this.ganttService.rowHeight+3*this.ganttService.rowHeight+"px":this.ganttActivityHeight=e.height+"px",this.ganttActivityWidth=e.width},m.prototype.setScale=function(){this.scale.start=this.start,this.scale.end=this.end},m.prototype.setDimensions=function(){this.dimensions.height=this.containerHeight,this.dimensions.width=this.containerWidth},m.prototype.setGridRowStyle=function(t){return t?{height:this.ganttService.rowHeight+"px","line-height":this.ganttService.rowHeight+"px","font-weight":"bold",cursor:"pointer"}:{height:this.ganttService.rowHeight+"px","line-height":this.ganttService.rowHeight+"px"}},m.prototype.zoomTasks=function(t){this.zoomLevel=t,this.zoom.emit(this.zoomLevel),this.containerWidth=this.calculateContainerWidth(),this.setDimensions(),document.querySelector(".gantt_activity").scrollLeft=0},m.prototype.expand=function(t){var e=document.querySelector(".gantt_vertical_scroll"),n=this.ganttService.TASK_CACHE.length*this.ganttService.rowHeight+3*this.ganttService.rowHeight+"px";t&&this.activityActions.expanded?this.ganttActivityHeight=n:this.activityActions.expanded?(this.activityActions.expanded=!1,this.activityActions.expandedIcon=this.downTriangle,this.ganttActivityHeight="300px"):(e.scrollTop=0,this.activityActions.expanded=!0,this.activityActions.expandedIcon=this.upTriangle,this.ganttActivityHeight=n)},m.prototype.getStatusIcon=function(t,e){return"Completed"===t||100===e&&"Error"!==t?"&#x2714;":"Warning"===t?"&#x25b2;":"Error"===t?"&#x2718;":""},m.prototype.getStatusIconColor=function(t,e){return"Completed"===t||100===e&&"Error"!==t?"green":"Warning"===t?"orange":"Error"===t?"red":""},m.prototype.setGridScaleStyle=function(){var t=this.ganttService.rowHeight;return this.zoomLevel===r[r.hours]&&(t*=2),{height:t+"px","line-height":t+"px"}},m.prototype.calculateContainerHeight=function(){return this.ganttService.TASK_CACHE.length*this.ganttService.rowHeight},m.prototype.calculateContainerWidth=function(){return this.zoomLevel===r[r.hours]?this.ganttService.TIME_SCALE.length*this.ganttService.hourCellWidth*24+this.ganttService.hourCellWidth:this.ganttService.TIME_SCALE.length*this.ganttService.cellWidth+this.ganttService.cellWidth},m.prototype.setSizes=function(){this.ganttActivityHeight=this.activityContainerSizes.height+"px",this.ganttActivityWidth=this.activityContainerSizes.width},m.decorators=[{type:i.Component,args:[{selector:"gantt-activity",template:'\n    <div class="actions-bar">\n        <div style="float: right"></div>\n    </div>\n    <div class="grid" #ganttGrid [ngStyle]="{ \'height\': ganttActivityHeight }">\n    <div class="grid-scale" [ngStyle]="setGridScaleStyle()">\n        <div class="grid-head-cell"\n            *ngFor="let column of gridColumns" [style.width]="column.width + \'px\'"\n            [style.left]="column.left + \'px\'">\n\n            <label>\n                {{column.name}}\n            </label>\n        </div>\n    </div>\n    <div class="grid-data"\n        #ganttGridData\n        [ngStyle]="{ \'height\': ganttService.calculateGanttHeight() }">\n\n    <div #row\n        *ngFor="let data of ganttService.groupData(ganttService.TASK_CACHE)"\n        (click)="toggleChildren(row, data)" class="grid-row"\n        [ngStyle]="setGridRowStyle(ganttService.isParent(data.treePath))"\n        [attr.data-id]="ganttService.setIdPrefix(data.id)"\n        [attr.data-isParent]="ganttService.isParent(data.treePath)"\n        [attr.data-parentid]="ganttService.setIdPrefix(data.parentId)">\n\n            <div class="grid-cell"\n                [ngStyle]="{ \'width\': gridColumns[1].width + \'px\', \'padding-left\': ganttService.isChild(data.treePath) }">\n\n                <div class="gantt-tree-content">{{data.name}}</div>\n            </div>\n        </div>\n    </div>\n    </div>\n    <div class="gantt-activity"\n        (window:resize)="onResize($event)"\n        [ngStyle]="{ \'height\': ganttActivityHeight, \'width\': ganttActivityWidth + 36 + \'px\'}">\n\n        <time-scale [zoom]="zoom"\n            [zoomLevel]="zoomLevel"\n            [timeScale]="ganttService.TIME_SCALE"\n            [dimensions]="dimensions"></time-scale>\n        <div class="gantt-activity-area"\n            #ganttActivityArea\n            [ngStyle]="{ \'height\': ganttService.calculateGanttHeight(), \'width\': containerWidth + \'px\'}">\n\n            <activity-background [zoom]="zoom"\n                [zoomLevel]="zoomLevel"\n                [timeScale]="ganttService.TIME_SCALE"\n                [tasks]="ganttService.TASK_CACHE"></activity-background>\n            <activity-bars [zoom]="zoom"\n                [zoomLevel]="zoomLevel"\n                [timeScale]="ganttService.TIME_SCALE"\n                [dimensions]="dimensions"\n                [tasks]="ganttService.TASK_CACHE"></activity-bars>\n        </div>\n    </div>\n    <div class="gantt-vertical-scroll"\n        #verticalScroll\n        (scroll)="onVerticalScroll(verticalScroll, ganttGrid, ganttActivityArea)"\n        [ngStyle]="{\'display\': activityActions.expanded === true ? \'none\' : \'block\' }">\n\n        <div [ngStyle]="{ \'height\': ganttService.calculateGanttHeight() }"></div>\n    </div>\n    ',changeDetection:i.ChangeDetectionStrategy.Default,styles:["\n        .gantt-activity {\n            /*overflow-x: hidden;*/\n            overflow-x: auto;\n            height: 250px;\n            overflow-y: hidden;\n            overflow-x: scroll;\n            display: inline-block;\n            vertical-align: top;\n            position:relative;\n        }\n        .gantt-activity-area {\n            position: relative;\n            overflow-x: hidden;\n            overflow-y: hidden;\n            -webkit-user-select: none;\n        }\n        .gantt-vertical-scroll {\n            background-color: transparent;\n            overflow-x: hidden;\n            overflow-y: scroll;\n            position: absolute;\n            right: 0;\n            display: block;\n            height: 283px;\n            width: 18px;\n            top: 70px;\n        }\n        .grid {\n            overflow-x: hidden;\n            overflow-y: hidden;\n            display: inline-block;\n            vertical-align: top;\n            border-right: 1px solid #cecece;\n        }\n        .grid-scale {\n            color: #6b6b6b;\n            font-size: 12px;\n            border-bottom: 1px solid #e0e0e0;\n            background-color: whitesmoke;\n        }\n        .grid-head-cell {\n            /*color: #a6a6a6;*/\n            border-top: none !important;\n            border-right: none !important;\n            line-height: inherit;\n            box-sizing: border-box;\n            display: inline-block;\n            vertical-align: top;\n            border-right: 1px solid #cecece;\n            /*text-align: center;*/\n            position: relative;\n            cursor: default;\n            height: 100%;\n            -moz-user-select: -moz-none;\n            -webkit-user-select: none;\n            overflow: hidden;\n        }\n        .grid-data {\n            overflow:hidden;\n        }\n        .grid-row {\n            box-sizing: border-box;\n            border-bottom: 1px solid #e0e0e0;\n            background-color: #fff;\n            position: relative;\n            -webkit-user-select: none;\n        }\n        .grid-row:hover {\n            background-color: #eeeeee;\n        }\n        .grid-cell {\n            border-right: none;\n            color: #454545;\n            display: inline-block;\n            vertical-align: top;\n            padding-left: 6px;\n            padding-right: 6px;\n            height: 100%;\n            overflow: hidden;\n            white-space: nowrap;\n            font-size: 13px;\n            box-sizing: border-box;\n        }\n        .actions-bar {\n            /*border-top: 1px solid #cecece;*/\n            border-bottom: 1px solid #e0e0e0;\n            clear: both;\n            /*margin-top: 90px;*/\n            height: 28px;\n            background: whitesmoke;\n            color: #494949;\n            font-family: Arial, sans-serif;\n            font-size: 13px;\n            padding-left: 15px;\n            line-height: 25px;\n        }\n        .gantt-tree-content {\n            padding-left:15px;\n        }\n    "]}]}],m.ctorParameters=function(){return[{type:i.ElementRef},{type:l}]},m.propDecorators={project:[{type:i.Input}],options:[{type:i.Input}],onGridRowClick:[{type:i.Output}]},m);function m(t,e){this.elem=t,this.ganttService=e,this.onGridRowClick=new i.EventEmitter,this.upTriangle="&#x25b2;",this.downTriangle="&#x25bc;",this.zoom=new i.EventEmitter,this.activityActions={expanded:!1,expandedIcon:this.downTriangle},this.zoomLevel=r[r.hours],this.treeExpanded=!1,this.scale={start:null,end:null},this.dimensions={height:0,width:0},this.data=[],this.gridColumns=[{name:"",left:0,width:16},{name:"Task",left:20,width:330}]}var b=(S.prototype.ngOnInit=function(){var e=this;this.zoom.subscribe(function(t){e.zoomLevel=t})},S.prototype.setTimescaleStyle=function(){return{width:this.dimensions.width+"px"}},S.prototype.setTimescaleLineStyle=function(t){return{height:this.ganttService.rowHeight+"px","line-height":this.ganttService.rowHeight+"px",position:"relative","border-top":t}},S.prototype.setTimescaleCellStyle=function(){var t=this.ganttService.cellWidth;return this.zoomLevel===r[r.hours]&&(t=24*this.ganttService.hourCellWidth+23),{width:t+"px"}},S.prototype.isDayWeekend=function(t){return this.ganttService.isDayWeekend(t)},S.prototype.getHours=function(){return this.ganttService.getHours(this.timeScale.length)},S.decorators=[{type:i.Component,args:[{selector:"time-scale",template:'\n        <div class="time-scale" [ngStyle]="setTimescaleStyle()">\n            <div class="time-scale-line" [ngStyle]="setTimescaleLineStyle(\'none\')">\n                <div class="time-scale-cell" *ngFor="let date of timeScale" \n                    [ngStyle]="setTimescaleCellStyle()"\n                    [ngClass]="(isDayWeekend(date)) ? \'weekend\' : \'\'">{{date | date: \'dd-MM-yyyy\'}}</div>\n            </div>\n            <div *ngIf="zoomLevel === \'hours\'" class="time-scale-line" [ngStyle]="setTimescaleLineStyle(\'1px solid #cecece\')">\n                <div class="time-scale-cell"\n                    *ngFor="let hour of getHours()"\n                    [ngStyle]="{ \'width\': ganttService.hourCellWidth + \'px\' }">{{hour}}</div>\n            </div>\n        </div>',providers:[l],styles:["\n        .weekend {\n            background-color: whitesmoke;\n        }\n        .time-scale {\n            font-size: 12px;\n            border-bottom: 1px solid #cecece;\n            background-color: #fff;\n        }\n        .time-scale-line {\n            box-sizing: border-box;\n        }\n        .time-scale-line:first-child {\n            border-top: none;\n        }\n        .time-scale-cell {\n            display: inline-block;\n            white-space: nowrap;\n            overflow: hidden;\n            border-right: 1px solid #cecece;\n            text-align: center;\n            height: 100%;\n        }"]}]}],S.ctorParameters=function(){return[{type:l}]},S.propDecorators={timeScale:[{type:i.Input}],dimensions:[{type:i.Input}],zoom:[{type:i.Input}],zoomLevel:[{type:i.Input}]},S);function S(t){this.ganttService=t}var w=(x.prototype.ngOnInit=function(){var e=this;this.drawGrid(),this.zoom.subscribe(function(t){e.zoomLevel=t,e.drawGrid()})},x.prototype.isDayWeekend=function(t){return this.ganttService.isDayWeekend(t)},x.prototype.setRowStyle=function(){return{height:this.ganttService.rowHeight+"px"}},x.prototype.setCellStyle=function(){var t=this.ganttService.cellWidth;return this.zoomLevel===r[r.hours]&&(t=this.ganttService.hourCellWidth),{width:t+"px"}},x.prototype.drawGrid=function(){var n=this;this.zoomLevel===r[r.hours]?(this.cells=[],this.timeScale.forEach(function(t){for(var e=0;e<=23;e++)n.cells.push(t)})):this.cells=this.timeScale},x.decorators=[{type:i.Component,args:[{selector:"activity-background",template:'\n    <div #bg class="gantt-activity-bg">\n        <div class="gantt-activity-row"\n            [ngStyle]="setRowStyle()"\n            *ngFor="let row of ganttService.groupData(tasks)">\n\n            <div class="gantt-activity-cell"\n                [ngStyle]="setCellStyle()"\n                *ngFor="let cell of cells; let l = last"\n                [ngClass]="[(isDayWeekend(cell)) ? \'weekend\' : \'\', l ? \'last-column-cell\' : \'\']"></div>\n        </div>\n    </div>\n    ',styles:["\n        .gantt-activity-bg {\n            overflow: hidden;\n        }\n        .gantt-activity-row {\n            border-bottom: 1px solid #ebebeb;\n            background-color: #fff;\n            box-sizing: border-box;\n        }\n        .gantt-activity-cell {\n            display: inline-block;\n            height: 100%;\n            border-right: 1px solid #ebebeb;\n        }\n        .weekend {\n            background-color: whitesmoke;\n        }\n    "]}]}],x.ctorParameters=function(){return[{type:l}]},x.propDecorators={tasks:[{type:i.Input}],timeScale:[{type:i.Input}],zoom:[{type:i.Input}],zoomLevel:[{type:i.Input}],bg:[{type:i.ViewChild,args:["bg"]}]},x);function x(t){this.ganttService=t,this.rows=[],this.cells=[]}var C=(k.prototype.ngOnInit=function(){var e=this;this.containerHeight=this.dimensions.height,this.containerWidth=this.dimensions.width,this.zoom.subscribe(function(t){e.zoomLevel=t})},k.prototype.expandLeft=function(t,r){t.stopPropagation();var o=this.ganttService,a=t.clientX,s=r.style.width,c=r.style.left;return this.addMouseEventListeners(function l(t){var e=o.cellWidth,n=s-t.clientX+a,i=Math.round(n/e);r.style.width=i*e+i,r.style.left=c-i*e-i}),!1},k.prototype.expandRight=function(t,r){t.stopPropagation();var o=this.ganttService,a=t.clientX,s=r.style.width;return r.task.end,r.style.left,this.addMouseEventListeners(function c(t){var e=o.cellWidth,n=s+t.clientX-a,i=Math.round(n/e);n<e&&(n=e,i=Math.round(n/e)),r.style.width=i*e+i}),!1},k.prototype.move=function(t,r){t.stopPropagation();var o=this.ganttService,a=t.clientX,s=r.style.left;return this.addMouseEventListeners(function c(t){var e=o.cellWidth,n=s+t.clientX-a,i=Math.round(n/e);r.style.left=i*e+i,n<0&&(r.style.left=0)}),!1},k.prototype.drawBar=function(t,e){return this.zoomLevel===r[r.hours]?this.ganttService.calculateBar(t,e,this.timeScale,!0):this.ganttService.calculateBar(t,e,this.timeScale)},k.prototype.drawProgress=function(t,e){var n=this.ganttService.getBarProgressStyle(t.status);return{width:this.ganttService.calculateBarProgress(this.ganttService.getComputedStyle(e,"width"),t.percentComplete),"background-color":n["background-color"]}},k.prototype.addMouseEventListeners=function(t){function e(){document.documentElement.removeEventListener("mousemove",t,!1),document.documentElement.removeEventListener("mouseup",e,!1),document.documentElement.removeEventListener("mouseleave",e,!1)}document.documentElement.addEventListener("mousemove",t,!1),document.documentElement.addEventListener("mouseup",e,!1),document.documentElement.addEventListener("mouseleave",e,!1)},k.decorators=[{type:i.Component,args:[{selector:"activity-bars",template:'\n    <div class="gantt-activity-bars-area" \n        [ngStyle]="{ \'height\': containerHeight + \'px\', \'width\': containerWidth + \'px\' }">\n\n        <div #bar class="gantt-activity-line"\n            *ngFor="let task of ganttService.groupData(tasks); let i = index"\n            [ngStyle]="drawBar(task, i)">\n\n            <div class="gantt-activity-progress" [ngStyle]="drawProgress(task, bar)"></div>\n            <div class="gantt-activity-progress_drag" style="left: 518px"></div>\n            <div class="gantt-activity-content"></div>\n            <div class="gantt-activity-link-control gantt-activity-right" style="height: 26px; line-height: 30px">\n                <div class="gantt-link-point"></div>\n            </div>\n            <div class="gantt-activity-link-control gantt-activity-left" style="height: 26px; line-height: 30px">\n                <div class="gantt-link-point"></div>\n            </div>\n        </div>\n    </div>\n    ',providers:[l],styles:['\n    .gantt-activity-line {\n        /*border-radius: 2px;*/\n        position: absolute;\n        box-sizing: border-box;\n        background-color: rgb(18,195,244);\n        border: 1px solid #2196F3;\n        -webkit-user-select: none;\n    }\n    .gantt-activity-line:hover {\n        /*cursor: move;*/\n    }\n    .gantt-activity-progress {\n        text-align: center;\n        z-index: 0;\n        background: #2196F3;\n        position: absolute;\n        min-height: 18px;\n        display: block;\n        height: 18px;\n    }\n    .gantt-activity-progress-drag {\n        height: 8px;\n        width: 8px;\n        bottom: -4px;\n        margin-left: 4px;\n        background-position: bottom;\n        background-image: "";\n        background-repeat: no-repeat;\n        z-index: 2;\n    }\n    .gantt-activity-content {\n        font-size: 12px;\n        color: #fff;\n        width: 100%;\n        top: 0;\n        position: absolute;\n        white-space: nowrap;\n        text-align: center;\n        line-height: inherit;\n        overflow: hidden;\n        height: 100%;\n    }\n    .gantt-activity-link-control {\n        position: absolute;\n        width: 13px;\n        top: 0;\n    }\n    .gantt-activity-right {\n        right: 0;\n    }\n    .gantt-activity-left {\n        left: 0;\n    }\n    .gantt-activity-right:hover {\n        cursor:w-resize;\n    }\n    .gantt-activity-left:hover {\n        cursor:w-resize;\n    }\n    ']}]}],k.ctorParameters=function(){return[{type:l}]},k.propDecorators={timeScale:[{type:i.Input}],dimensions:[{type:i.Input}],tasks:[{type:i.Input}],zoom:[{type:i.Input}],zoomLevel:[{type:i.Input}]},k);function k(t){this.ganttService=t,this.containerHeight=0,this.containerWidth=0}var A=(E.decorators=[{type:i.NgModule,args:[{imports:[n.CommonModule],exports:[f,b,w,C],declarations:[f,b,w,C],providers:[]}]}],E);function E(){}var H=(z.decorators=[{type:i.NgModule,args:[{imports:[n.CommonModule,e.FormsModule,A],exports:[h],declarations:[h,g,v,s],providers:[l]}]}],z);function z(){}t.Zooming=r,t.GanttModule=H,t.ɵe=w,t.ɵf=C,t.ɵb=f,t.ɵa=A,t.ɵd=b,t.ɵi=v,t.ɵg=h,t.ɵh=g,t.ɵj=s,t.ɵc=l,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=angular-gantt.umd.min.js.map